(nodes
	("muxOut" (param "width") 0 1)
	("select" 1 0 1)
	("nselect" 1 0 1)
	("bselect" 1 0 1)
)
(gates
	(case (param "inputCount")
		((2)
			(if (and suggest-buffers (>= (param "width") 4))
				(cell "suggested-buffer" (node "bselect") (node "select"))
				(connect (node "select") (node "bselect"))
			)
			(cell "set-reset-flip-flop"
				(req (bundle "inp" 1))
				(req (bundle "inp" 0))
				(node "select")
				(node "nselect")
			)
			(and
				(combine (ack (each "inp")))
				(combine (node "nselect") (node "select"))
				(combine (dup 2 (ack "out")))
			)
			(mux2 (req "out") (req (each "inp")) (node "bselect"))
			(mux2 (data "out") (data (each "inp")) (combine (dup (param "width") (node "bselect"))))
		)
		(else
			(or (req "out") (req (each "inp")))
			(c-element
				(combine (ack (each "inp")))
				(combine (req (each "inp")))
				(combine (dup (param "inputCount") (ack "out")))
			)
			(tri-inv
				(combine (dup-each (param "width") (req (each "inp"))))
				(combine (data (each "inp")))
				(combine (dup (param "inputCount") (node "muxOut")))
			)
			(keeper-inv (data "out") (node "muxOut"))
		)
	)
)
